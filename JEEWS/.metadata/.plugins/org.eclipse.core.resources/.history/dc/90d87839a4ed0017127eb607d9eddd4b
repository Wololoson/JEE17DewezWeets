package be.gestionhopital.Controllers;

import java.io.IOException;

import javax.servlet.ServletConfig;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

import be.gestionhopital.Models.Chirurgien;
import be.gestionhopital.Models.Directeur;
import be.gestionhopital.Models.Secretaire;

/**
 * Servlet implementation class ServletAcceuil
 */
public class ServletAcceuil extends HttpServlet {
	private static final long serialVersionUID = 1L;
	private String urlReservation = null;
	private String urlNotification = null;
	private String urlInformation = null;
	private String urlPatient = null;
	private String urlPersonnel = null;
	
	public void init() {
		ServletConfig config = getServletConfig();
		urlReservation = (String)config.getInitParameter("urlReservation");
		urlNotification = (String)config.getInitParameter("urlNotification");
		urlInformation = (String)config.getInitParameter("urlInformation");
		urlPatient = (String)config.getInitParameter("urlPatient");
		urlPersonnel = (String)config.getInitParameter("urlPersonnel");
	}

	/**
	 * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)
	 */
	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		HttpSession sess = request.getSession();
		if(sess.getAttribute("type").equals("chirurgien")) {
			Chirurgien connected = (Chirurgien) sess.getAttribute("chirurgien");
			String chirRes = (String) request.getAttribute("chirRes");
			String chirNoti = (String) request.getAttribute("chirNoti");
			String chirInfo = (String) request.getAttribute("chirInfo");
			if(chirRes != null) {
				getServletContext().getRequestDispatcher(urlReservation).forward(request, response);
			}
			if(chirNoti != null) {
				getServletContext().getRequestDispatcher(urlNotification).forward(request, response);
			}
			if(chirInfo != null) {
				getServletContext().getRequestDispatcher(urlInformation).forward(request, response);
			}
		}
		if(sess.getAttribute("type").equals("secretaire")) {
			Secretaire connected = (Secretaire) sess.getAttribute("secretaire");
			String secrRes = (String) request.getAttribute("secrRes");
			String secrPati = (String) request.getAttribute("secrPati");
			String secrInfo = (String) request.getAttribute("secrInfo");
			if(secrRes != null) {
				getServletContext().getRequestDispatcher(urlReservation).forward(request, response);
			}
			if(secrPati != null) {
				getServletContext().getRequestDispatcher(urlPatient).forward(request, response);
			}
			if(secrInfo != null) {
				getServletContext().getRequestDispatcher(urlInformation).forward(request, response);
			}
		}
		if(sess.getAttribute("type").equals("directeur")) {
			Directeur connected = (Directeur) sess.getAttribute("directeur");
			String direRes = (String) request.getAttribute("direRes");
			String direPati = (String) request.getAttribute("direPati");
			String direPers = (String) request.getAttribute("direPers");
			String direInfo = (String) request.getAttribute("direInfo");
			
			if(direRes != null) {
				getServletContext().getRequestDispatcher(urlReservation).forward(request, response);
			}
			if(direPati != null) {
				getServletContext().getRequestDispatcher(urlNotification).forward(request, response);
			}
			if(direPers != null) {
				getServletContext().getRequestDispatcher(urlPatient).forward(request, response);
			}
			if(direInfo != null) {
				getServletContext().getRequestDispatcher(urlInformation).forward(request, response);
			}
		}	
	}

	/**
	 * @see HttpServlet#doPost(HttpServletRequest request, HttpServletResponse response)
	 */
	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
		doGet(request, response);
	}

}
